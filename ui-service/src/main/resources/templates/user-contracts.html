<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Hợp đồng</title>
    <script th:src="@{/js/user-guard.js}"></script>

    <link rel="stylesheet" th:href="@{/css/user-layout.css}">

    <link rel="stylesheet" th:href="@{/css/user-contracts.css}">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<div class="user-layout-container">

    <div th:insert="~{fragments/sidebar-user :: sidebar-user(currentPage='contracts')}"></div>

    <main class="main-content">
        <div th:insert="~{fragments/header-user :: header-user(pageTitle='Quản lý Hợp đồng')}"></div>

        <div class="page-header">
            <h1>Quản lý Hợp đồng</h1>
            <button class="btn-create-contract" id="btn-create-contract">
                <i class="fas fa-plus"></i> Tạo hợp đồng mới
            </button>
        </div>

        <div class="stats-grid" id="stats-grid">
        </div>

        <div id="status-message" style="display: none; margin-bottom: 20px;"></div>

        <div class="filter-bar">
            <div class="filter-tabs">
                <button class="tab-item active" data-status="all">Tất cả</button>
                <button class="tab-item" data-status="pending">Chờ ký/Dự thảo</button>
                <button class="tab-item" data-status="signed">Đang hoạt động</button>
                <button class="tab-item" data-status="archived">Đã kết thúc</button>
            </div>
            <div class="search-group">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Tìm theo Mã HĐ, Mã Nhóm...">
            </div>
        </div>

        <div class="table-container">
            <table class="contract-table">
                <thead>
                <tr>
                    <th>Mã hợp đồng</th>
                    <th>Thông tin xe/nhóm</th>
                    <th>Ngày tạo</th>
                    <th>Loại hợp đồng</th>
                    <th>Trạng thái</th>
                    <th>Thao tác</th>
                </tr>
                </thead>
                <tbody id="contract-table-body">
                </tbody>
            </table>
<<<<<<< HEAD
            <div class="pagination-container">
                <span id="pagination-info">Hiển thị 1-10 của 10 kết quả</span>
                <div class="pagination-buttons">
                    <button id="prevPage" disabled>Trước</button>
                    <button class="active">1</button>
                    <button id="nextPage" disabled>Sau</button>
                </div>
            </div>
        </div>

        <div class="quick-actions-grid">
            <a href="#" class="quick-action-card">
                <div class="stat-icon blue"><i class="fas fa-file-signature"></i></div>
                <div>
                    <h4>Ký hợp đồng điện tử</h4>
                    <p>Ký các hợp đồng đang chờ</p>
                </div>
            </a>
            <a href="#" class="quick-action-card">
                <div class="stat-icon green"><i class="fas fa-download"></i></div>
                <div>
                    <h4>Tải xuống hợp đồng</h4>
                    <p>Xuất file PDF hợp đồng</p>
                </div>
            </a>
            <a href="#" class="quick-action-card">
                <div class="stat-icon orange"><i class="fas fa-chart-line"></i></div>
                <div>
                    <h4>Báo cáo hợp đồng</h4>
                    <p>Xem thống kê chi tiết</p>
                </div>
            </a>
=======
>>>>>>> 17c2e87 (Lưu tạm thay đổi trước khi pull)
        </div>

    </main>
</div>

<<<<<<< HEAD
<div id="createContractModal" class="modal-backdrop">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Tạo Hợp đồng Đồng sở hữu Mới</h2>
            <span class="modal-close" id="modalCloseButton">&times;</span>
        </div>
        <form id="createContractForm">
            <div class="modal-body">
                <p>Vui lòng chọn xe bạn muốn tạo hợp đồng và thời hạn.</p>

                <div id="modal-error-message" class="status-message error" style="display: none;"></div>

                <div class="form-group">
                    <label for="vehicleSelect">Chọn xe có sẵn:</label>
                    <select id="vehicleSelect" required>
                        <option value="">Đang tải danh sách xe...</option>
=======
<div id="createContractModal" class="modal-backdrop" style="display: none;">
    <div class="modal-content" style="max-width: 800px;"> <form id="createContractForm">
        <div class="modal-step active" id="modal-step-1">
            <div class="modal-header">
                <h2>Tạo Hợp Đồng Mới (Bước 1/3): Chọn Xe</h2>
                <span class="modal-close" id="modalCloseButton">&times;</span>
            </div>
            <div class="modal-body" style="max-height: 60vh; overflow-y: auto;">
                <p>Chọn một xe còn trống dưới đây để bắt đầu tạo hợp đồng đồng sở hữu.</p>
                <div id="vehicle-selection-list" class="vehicle-list-container">
                </div>
                <div id="vehicle-list-loading" style="text-align: center; padding: 20px;">Đang tải danh sách xe...</div>
            </div>
            <div class="modal-footer" style="justify-content: space-between;">
                <span id="step1-error-message" style="color: red; font-size: 0.9rem;"></span>
                <button type="button" class="btn-primary" id="btn-step1-next" disabled>Tiếp theo</button>
            </div>
        </div>

        <div class="modal-step" id="modal-step-2" style="display: none;">
            <div class="modal-header">
                <h2>Tạo Hợp Đồng Mới (Bước 2/3): Chi tiết Hợp đồng</h2>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="modal-error-message" class="status-message error" style="display: none;"></div>

                <div class="form-group">
                    <label for="contractType">Loại Hợp Đồng <span style="color: red;">*</span></label>
                    <select id="contractType" required>
                        <option value="co_ownership" selected>Đồng sở hữu (Co-ownership)</option>
                        <option value="rental">Thuê (Rental)</option>
                        <option value="other">Khác</option>
>>>>>>> 17c2e87 (Lưu tạm thay đổi trước khi pull)
                    </select>
                </div>

                <div class="form-group">
<<<<<<< HEAD
                    <label for="durationSelect">Chọn thời hạn hợp đồng:</label>
                    <select id="durationSelect" required>
                        <option value="12">12 tháng</option>
                        <option value="24" selected>24 tháng</option>
                        <option value="36">36 tháng</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="modalCancelButton" class="btn-secondary">Hủy</button>
                <button type="submit" id="modalSubmitButton" class="btn-primary">
                    <i class="fas fa-plus"></i> Tạo Hợp đồng
                </button>
            </div>
        </form>
    </div>
</div>
=======
                    <label for="contractCode">Mã Hợp đồng (Tùy chọn)</label>
                    <input type="text" id="contractCode" placeholder="Bỏ trống để tự động tạo (ví dụ: HD-CO-123)">
                </div>

                <div class="form-group">
                    <label for="contractDescription">Mô Tả (Tùy chọn)</label>
                    <textarea id="contractDescription" rows="3" placeholder="Nhập mô tả hoặc ghi chú..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="btn-step2-back">Quay lại</button>
                <button type="button" class="btn-primary" id="btn-step2-next">Tiếp theo (Xác nhận)</button>
            </div>
        </div>

        <div class="modal-step" id="modal-step-3" style="display: none;">
            <div class="modal-header">
                <h2>Tạo Hợp Đồng Mới (Bước 3/3): Xác nhận và Ký</h2>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <p>Vui lòng xem lại thông tin. Bằng cách nhấp vào "Xác nhận Tạo", bạn đồng ý với các điều khoản và hợp đồng sẽ được tạo ở trạng thái "Dự thảo".</p>
                <div id="summary-info" style="padding: 15px; background: #f9f9f9; border-radius: 8px;">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="btn-step3-back">Quay lại</button>
                <button type="submit" class="btn-primary">Xác nhận Tạo</button>
            </div>
        </div>

    </form>
    </div>
</div>

>>>>>>> 17c2e87 (Lưu tạm thay đổi trước khi pull)
<script th:src="@{/js/auth-utils.js}"></script>
<script th:src="@{/js/user-contracts.js}"></script>

</body>
</html>