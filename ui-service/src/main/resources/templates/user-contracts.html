<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Hợp đồng</title>
    <script th:src="@{/js/user-guard.js}"></script>

    <link rel="stylesheet" th:href="@{/css/user-layout.css}">
    <link rel="stylesheet" th:href="@{/css/user-contracts.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
<div class="user-layout-container">

    <div th:insert="~{fragments/sidebar-user :: sidebar-user(currentPage='contracts')}"></div>

    <main class="main-content">
        <div th:insert="~{fragments/header-user :: header-user(pageTitle='Quản lý Hợp đồng')}"></div>

        <div class="page-header">

            <button class="btn-create-contract" id="btn-create-contract">
                <i class="fas fa-plus"></i> Tạo hợp đồng mới
            </button>
        </div>

        <div class="stats-grid" id="stats-grid">
        </div>

        <div id="status-message" style="display: none; margin-bottom: 20px;"></div>

        <div class="filter-bar">
            <div class="search-group">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Tìm kiếm hợp đồng...">
            </div>
            <div class="filter-group">
                <select id="statusFilter">
                    <option value="">Tất cả trạng thái</option>
                    <option value="ACTIVE">Đang hoạt động</option>
                    <option value="PENDING">Chờ ký</option>
                    <option value="EXPIRED">Đã kết thúc</option>
                </select>
            </div>
            <div class="filter-group">
                <select id="vehicleFilter">
                    <option value="">Tất cả loại xe</option>
                </select>
            </div>
        </div>

        <div class="table-container">
            <table class="contract-table">
                <thead>
                <tr>
                    <th>Mã hợp đồng</th>
                    <th>Thông tin xe</th>
                    <th>Ngày ký</th>
                    <th>Thời hạn</th>
                    <th>Trạng thái</th>
                    <th>Thao tác</th>
                </tr>
                </thead>
                <tbody id="contract-table-body">
                </tbody>
            </table>
            <div class="pagination-container">
                <span id="pagination-info">Hiển thị 1-10 của 10 kết quả</span>
                <div class="pagination-buttons">
                    <button id="prevPage" disabled>Trước</button>
                    <button class="active">1</button>
                    <button id="nextPage" disabled>Sau</button>
                </div>
            </div>
        </div>

        <div class="quick-actions-grid">
            <a href="#" class="quick-action-card">
                <div class="stat-icon blue"><i class="fas fa-file-signature"></i></div>
                <div>
                    <h4>Ký hợp đồng điện tử</h4>
                    <p>Ký các hợp đồng đang chờ</p>
                </div>
            </a>
            <a href="#" class="quick-action-card">
                <div class="stat-icon green"><i class="fas fa-download"></i></div>
                <div>
                    <h4>Tải xuống hợp đồng</h4>
                    <p>Xuất file PDF hợp đồng</p>
                </div>
            </a>
            <a href="#" class="quick-action-card">
                <div class="stat-icon orange"><i class="fas fa-chart-line"></i></div>
                <div>
                    <h4>Báo cáo hợp đồng</h4>
                    <p>Xem thống kê chi tiết</p>
                </div>
            </a>
        </div>

    </main>
</div>

<div id="createContractModal" class="modal-backdrop">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Tạo Hợp đồng Đồng sở hữu Mới</h2>
            <span class="modal-close" id="modalCloseButton">&times;</span>
        </div>
        <form id="createContractForm">
            <div class="modal-body">
                <p>Vui lòng chọn xe bạn muốn tạo hợp đồng và thời hạn.</p>

                <div id="modal-error-message" class="status-message error" style="display: none;"></div>

                <div class="form-group">
                    <label for="vehicleSelect">Chọn xe có sẵn:</label>
                    <select id="vehicleSelect" required>
                        <option value="">Đang tải danh sách xe...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="durationSelect">Chọn thời hạn hợp đồng:</label>
                    <select id="durationSelect" required>
                        <option value="12">12 tháng</option>
                        <option value="24" selected>24 tháng</option>
                        <option value="36">36 tháng</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="modalCancelButton" class="btn-secondary">Hủy</button>
                <button type="submit" id="modalSubmitButton" class="btn-primary">
                    <i class="fas fa-plus"></i> Tạo Hợp đồng
                </button>
            </div>
        </form>
    </div>
</div>

<script th:src="@{/js/auth-utils.js}"></script>
<script th:src="@{/js/user-contracts.js}"></script>

</body>
</html>